<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab 4 - Solutions – MA-M27 Lab Assignments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Lab3-solutions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8fef5d38915f831591fa3b4cafce98b5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Lab 4 - Solutions – MA-M27 Lab Assignments">
<meta property="og:description" content="Lab Assignments for MA-M27 Probability and Statistics for Data Science">
<meta property="og:image" content="Lab4-solutions_files/figure-html/cell-3-output-1.png">
<meta property="og:site_name" content="MA-M27 Lab Assignments">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Lab1-solutions.html">Labs - Solutions</a></li><li class="breadcrumb-item"><a href="./Lab4-solutions.html">Lab 4 - Solutions</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/wordcloud.jpg" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="./images/wordcloud.jpg" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Labs - Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lab1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1 - Problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lab2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2 - Problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lab3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3 - Problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lab4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4 - Problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lab5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 5 - Problems</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Labs - Solutions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lab1-solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1 - Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lab2-solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2 - Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lab3-solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3 - Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lab4-solutions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lab 4 - Solutions</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">In this Lab</h2>
   
  <ul>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link active" data-scroll-target="#linear-regression"><span class="header-section-number">1</span> Linear Regression</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">1.1</span> </a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="header-section-number">1.2</span> </a>
  <ul class="collapse">
  <li><a href="#manual-calculation" id="toc-manual-calculation" class="nav-link" data-scroll-target="#manual-calculation">Manual calculation</a></li>
  </ul></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"><span class="header-section-number">1.3</span> </a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"><span class="header-section-number">1.4</span> </a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"><span class="header-section-number">1.5</span> </a>
  <ul class="collapse">
  <li><a href="#linregress-function" id="toc-linregress-function" class="nav-link" data-scroll-target="#linregress-function">Linregress function</a></li>
  </ul></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"><span class="header-section-number">1.6</span> </a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"><span class="header-section-number">1.7</span> </a></li>
  </ul></li>
  <li><a href="#binary-logistic-regression" id="toc-binary-logistic-regression" class="nav-link" data-scroll-target="#binary-logistic-regression"><span class="header-section-number">2</span> (Binary) Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#investigating-data" id="toc-investigating-data" class="nav-link" data-scroll-target="#investigating-data">Investigating data</a></li>
  <li><a href="#separating-data" id="toc-separating-data" class="nav-link" data-scroll-target="#separating-data">Separating data</a></li>
  <li><a href="#logistic-regression-for-1-independent-variable" id="toc-logistic-regression-for-1-independent-variable" class="nav-link" data-scroll-target="#logistic-regression-for-1-independent-variable">Logistic regression for 1 independent variable</a></li>
  <li><a href="#logistic-regression-for-2-independent-variables" id="toc-logistic-regression-for-2-independent-variables" class="nav-link" data-scroll-target="#logistic-regression-for-2-independent-variables">Logistic regression for 2 independent variables</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7"><span class="header-section-number">2.1</span> </a>
  <ul class="collapse">
  <li><a href="#logistic-regression-for-3-independent-variables" id="toc-logistic-regression-for-3-independent-variables" class="nav-link" data-scroll-target="#logistic-regression-for-3-independent-variables">Logistic regression for 3 independent variables</a></li>
  </ul></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8"><span class="header-section-number">2.2</span> </a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9"><span class="header-section-number">2.3</span> </a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Lab1-solutions.html">Labs - Solutions</a></li><li class="breadcrumb-item"><a href="./Lab4-solutions.html">Lab 4 - Solutions</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Lab 4 - Solutions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="linear-regression" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Linear Regression</h1>
<p>Recall that the linear regression provides the “best line” that reflects the relation between two sets of data. Namely, let <span class="math inline">\(X=(x_1,\ldots,x_n)\)</span> and <span class="math inline">\(Y=(y_1,\ldots,y_n)\)</span> be vectors (arrays) of data. We define</p>
<p><span class="math display">\[
\begin{aligned}
\bar{x}&amp; = \frac1n \sum_{i=1}^n x_i,\\
S_{xx} &amp;= \sum_{i=1}^n(x_i-\bar{x})^2=\sum_{i=1}^nx_i^2-n\bar{x}^2,\\
S_{xy}&amp;=\sum_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})=\sum_{i=1}^nx_iy_i-n\bar{x}\bar{y},\\
S_{yy}&amp;= \sum_{i=1}^n(y_i-\bar{y})^2=\sum_{i=1}^ny_i^2-n\bar{y}^2.
\end{aligned}
\]</span></p>
<p>Then the best fit line is</p>
<p><span class="math display">\[
\hat{y}=\hat{\beta}_0+\hat{\beta}_1 x,
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\begin{aligned}
\hat{\beta}_1 &amp;= \dfrac{S_{xy}}{S_{xx}},\\
\hat{\beta}_0 &amp;= \bar{y}-\hat{\beta}_1\bar{x}.
\end{aligned}
\]</span></p>
<p>The strength of a linear relationship between the variables can be measured by the Pearson correlation coefficient (or just the correlation coefficient) which is given by</p>
<p><span class="math display">\[
r=\dfrac{S_{xy}}{\sqrt{S_{xx}S_{yy}}}.
\]</span></p>
<p>We know that <span class="math inline">\(-1\leq r\leq 1\)</span> and we say that</p>
<p><span class="math display">\[
\begin{aligned}
|r|&gt;0.7 &amp; \quad \text{means strong correlation}\\
0.7\geq |r|&gt;0.4&amp; \quad \text{means moderate correlation}\\
|r|\leq 0.4 &amp; \quad \text{means weak correlation}
\end{aligned}
\]</span></p>
<section id="section" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="section"><span class="header-section-number">1.1</span> </h2>
<div class="task">
<p>Download file <code>Birthweight.csv</code> from Canvas (see Week 4 section in Modules) and upload it to <code>Anaconda.com/app</code>. Assign it to the dataframe named <code>df</code>. Show the first rows of <code>df</code>.</p>
<p><em>Hint:</em> to import CSV file, use commands discussed in Lab 3. Don’t forget about <code>pandas</code> library.</p>
<p>You should get the following output</p>
<div id="26763db1" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"Birthweight.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">headcircumference</th>
<th data-quarto-table-cell-role="th">length</th>
<th data-quarto-table-cell-role="th">Birthweight</th>
<th data-quarto-table-cell-role="th">Gestation</th>
<th data-quarto-table-cell-role="th">smoker</th>
<th data-quarto-table-cell-role="th">motherage</th>
<th data-quarto-table-cell-role="th">mnocig</th>
<th data-quarto-table-cell-role="th">mheight</th>
<th data-quarto-table-cell-role="th">mppwt</th>
<th data-quarto-table-cell-role="th">fage</th>
<th data-quarto-table-cell-role="th">fedyrs</th>
<th data-quarto-table-cell-role="th">fnocig</th>
<th data-quarto-table-cell-role="th">fheight</th>
<th data-quarto-table-cell-role="th">lowbwt</th>
<th data-quarto-table-cell-role="th">mage35</th>
<th data-quarto-table-cell-role="th">LowBirthWeight</th>
<th data-quarto-table-cell-role="th">QCL_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1313</td>
<td>12</td>
<td>17</td>
<td>5.8</td>
<td>33</td>
<td>0</td>
<td>24</td>
<td>0</td>
<td>58</td>
<td>99</td>
<td>26</td>
<td>16</td>
<td>0</td>
<td>66</td>
<td>1</td>
<td>0</td>
<td>Low</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>431</td>
<td>12</td>
<td>19</td>
<td>4.2</td>
<td>33</td>
<td>1</td>
<td>20</td>
<td>7</td>
<td>63</td>
<td>109</td>
<td>20</td>
<td>10</td>
<td>35</td>
<td>71</td>
<td>1</td>
<td>0</td>
<td>Low</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>808</td>
<td>13</td>
<td>19</td>
<td>6.4</td>
<td>34</td>
<td>0</td>
<td>26</td>
<td>0</td>
<td>65</td>
<td>140</td>
<td>25</td>
<td>12</td>
<td>25</td>
<td>69</td>
<td>0</td>
<td>0</td>
<td>Normal</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>300</td>
<td>12</td>
<td>18</td>
<td>4.5</td>
<td>35</td>
<td>1</td>
<td>41</td>
<td>7</td>
<td>65</td>
<td>125</td>
<td>37</td>
<td>14</td>
<td>25</td>
<td>68</td>
<td>1</td>
<td>1</td>
<td>Low</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>516</td>
<td>13</td>
<td>18</td>
<td>5.8</td>
<td>35</td>
<td>1</td>
<td>20</td>
<td>35</td>
<td>67</td>
<td>125</td>
<td>23</td>
<td>12</td>
<td>50</td>
<td>73</td>
<td>1</td>
<td>0</td>
<td>Low</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>As you can see, this dataframe contains the data about newborns and their parents. (Here values of <code>headcircumference</code> and <code>length</code> are in inches and <code>Birthweight</code> is in pounds.)</p>
<p>We will study dependence of newborn’s weights on their lengths.</p>
</section>
<section id="section-1" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="section-1"><span class="header-section-number">1.2</span> </h2>
<div class="task">
<p>Plot a scatter plot making <code>length</code> data on the horizontal axes and <code>Birthweight</code> data on the vertical axes. Label axes appropriately, and show in labels the units (<code>in</code> and <code>lb</code>).</p>
<p><em>Hint:</em> use commands discussed in Lab 3. Don’t forget about <code>matplotlib.pyplot</code> module. Note also that <code>matplotlib</code> allows to use Pandas series (e.g.&nbsp;dataframe columns), it’s <em>not necessary</em> to convert them into Numpy arrays using <code>.to_numpy()</code> command.</p>
<div id="ecded6d7" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(df[<span class="st">'length'</span>], df[<span class="st">'Birthweight'</span>])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Length (in)'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Weight (lb)'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab4-solutions_files/figure-html/cell-3-output-1.png" width="585" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<section id="manual-calculation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="manual-calculation">Manual calculation</h3>
<p>At first, we calculate the regression line manually, using the formulas above.</p>
</section>
</section>
<section id="section-2" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="section-2"><span class="header-section-number">1.3</span> </h2>
<div class="task">
<p>Convert columns <code>length</code> and <code>Birthweight</code> to Numpy arrays <code>x</code> and <code>y</code>, respectively. Assign <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> to <code>mx</code> and <code>my</code>, respectively. Note that you may use either <code>mean</code> or <code>np.mean</code> functions.</p>
<div id="05ce3bea" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df[<span class="st">'length'</span>].to_numpy()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'Birthweight'</span>].to_numpy()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>mx <span class="op">=</span> np.mean(x)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>my <span class="op">=</span> np.mean(y)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Check your answer:</p>
<div id="9dd292fd" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>[mx, my]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>[19.928571428571427, 7.264285714285713]</code></pre>
</div>
</div>
</div>
</section>
<section id="section-3" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="section-3"><span class="header-section-number">1.4</span> </h2>
<div class="task">
<p>Assign values of <span class="math inline">\(S_{xx}, S_{xy}, S_{yy}\)</span> to variables <code>sxx</code>, <code>sxy</code>, and <code>syy</code>, respectively (use the formulas at the beginning of this Lab). Note that you can use functions <code>sum</code> or <code>np.sum</code>, and remember about vector operations in Python.</p>
<div id="e4d02f9b" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sxx <span class="op">=</span> np.<span class="bu">sum</span>((x<span class="op">-</span>mx)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sxy <span class="op">=</span> np.<span class="bu">sum</span>((x<span class="op">-</span>mx)<span class="op">*</span>(y<span class="op">-</span>my))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>syy<span class="op">=</span> np.<span class="bu">sum</span>((y<span class="op">-</span>my)<span class="op">**</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Check the answer:</p>
<div id="cf4721b9" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>[sxx, sxy, syy]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>[50.785714285714285, 42.292857142857144, 72.49642857142857]</code></pre>
</div>
</div>
</div>
</section>
<section id="section-4" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="section-4"><span class="header-section-number">1.5</span> </h2>
<div class="task">
<p>Assign values of <span class="math inline">\(\hat{\beta}_1\)</span> and <span class="math inline">\(\hat{\beta}_0\)</span> to variables <code>b1</code> and <code>b0</code>, respectively. Assign the Pearson regression coefficient to variable <code>r</code>. (To find the square root, you may use <code>np.sqrt</code> function.)</p>
<div id="e2b60b3a" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> sxy<span class="op">/</span>sxx</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="op">=</span> my <span class="op">-</span> b1 <span class="op">*</span> mx</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> sxy <span class="op">/</span> np.sqrt(sxx <span class="op">*</span> syy)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Check the answer:</p>
<div id="3db46328" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>[b0, b1, r]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>[-9.331645569620253, 0.8327707454289733, 0.6970082792022007]</code></pre>
</div>
</div>
</div>
<section id="linregress-function" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="linregress-function">Linregress function</h3>
<p>Instead of all these calculations, we can also use <code>linregress</code> class from <code>scipy.stats</code> module:</p>
<div id="2e7baa8c" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> linregress</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>linregress(x,y)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>LinregressResult(slope=0.8327707454289743, intercept=-9.331645569620274, rvalue=0.697008279202201, pvalue=2.9301969030655954e-07, stderr=0.13546119087983002, intercept_stderr=2.7036545086005135)</code></pre>
</div>
</div>
<p>You may notice that it gives the same answers (up to a little calculation error), where <code>slope</code> stands for <code>b1</code> (that is indeed the slope of <span class="math inline">\(\hat{y}=\hat{\beta}_0+\hat{\beta}_1 x\)</span>), <code>intercept</code> stands for <code>b0</code>, and <code>rvalue</code> stands for <code>r</code>. You may access these values as follows:</p>
<div id="9a162e01" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lr <span class="op">=</span> linregress(x,y)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>[lr.intercept, lr.slope, lr.rvalue]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>[-9.331645569620274, 0.8327707454289743, 0.697008279202201]</code></pre>
</div>
</div>
<p>that is pretty simular to <code>[b0, b1, r]</code> calculated before.</p>
<p>We are going now to draw now the graph of the regression line on the scatter plot. For this, we create an array of values on the horizontal axes by dividing the interval between <code>min(x)</code> and <code>max(x)</code> by e.g.&nbsp;<span class="math inline">\(100\)</span> parts (for this we will use <code>np.linespace</code> function), and calculate the values of the linear regression line at these points:</p>
<div id="e4f44ed8" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>xvalues <span class="op">=</span> np.linspace(<span class="bu">min</span>(x), <span class="bu">max</span>(x), <span class="dv">100</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>yvalues <span class="op">=</span> lr.intercept <span class="op">+</span> lr.slope <span class="op">*</span> xvalues</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>plt.plot(xvalues, yvalues, color <span class="op">=</span> <span class="st">'r'</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab4-solutions_files/figure-html/cell-12-output-1.png" width="558" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="section-5" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="section-5"><span class="header-section-number">1.6</span> </h2>
<div class="task">
<p>Combine the regression line with the scatter plot to get the following output:</p>
<div id="c37b5f58" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>xvalues <span class="op">=</span> np.linspace(<span class="bu">min</span>(x), <span class="bu">max</span>(x), <span class="dv">100</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>yvalues <span class="op">=</span> lr.intercept <span class="op">+</span> lr.slope <span class="op">*</span> xvalues</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.plot(xvalues, yvalues, color <span class="op">=</span> <span class="st">'r'</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Length (in)'</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Weight (lb)'</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab4-solutions_files/figure-html/cell-13-output-1.png" width="585" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As we can see, the regression line reflects the trend between weights and lengths, however, the values are “jumping” around the line. We could see that the correlation coefficient (see <code>lr.rvalue</code> or <code>r</code>) is not large:</p>
<div id="7edb966f" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lr.rvalue</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>0.697008279202201</code></pre>
</div>
</div>
<p>i.e.&nbsp;we see here a <em>moderate</em> correlation.</p>
</div>
</section>
<section id="section-6" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="section-6"><span class="header-section-number">1.7</span> </h2>
<div class="task">
<p>Download now file <code>Experience-Salary.csv</code> which contains data on how the salary depends on experience. Repeat the previous steps to show the scatter plot together with the regression line:</p>
<div id="9a9daf42" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"Experience-Salary.csv"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df[<span class="st">'exp(in months)'</span>].to_numpy()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'salary(in thousands)'</span>].to_numpy()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>lr <span class="op">=</span> linregress(x,y)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>xvalues <span class="op">=</span> np.linspace(<span class="bu">min</span>(x), <span class="bu">max</span>(x), <span class="dv">100</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>yvalues <span class="op">=</span> lr.intercept <span class="op">+</span> lr.slope <span class="op">*</span> xvalues</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>plt.plot(xvalues, yvalues, color <span class="op">=</span> <span class="st">'r'</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Experience (months)'</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Salary (thousands)'</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab4-solutions_files/figure-html/cell-15-output-1.png" width="585" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>You can see that here the regression line fits the data better. Indeed, in this case the correlation is higher:</p>
<div id="be290389" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lr.rvalue <span class="co">#If you kept the notation lr for linregress object.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>0.8109692945840655</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="binary-logistic-regression" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> (Binary) Logistic Regression</h1>
<p>In contrast to the linear regression, the binary logistic regression can be applied if the dependent variable takes only two values, e.g.&nbsp;<span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. For example, download file <code>colleges.csv</code> from Week 4 of Canvas Modules, and upload it to <code>Anaconda.com/app</code>.</p>
<section id="investigating-data" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="investigating-data">Investigating data</h3>
<div id="3acc9953" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"colleges.csv"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df.tail()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">gmat</th>
<th data-quarto-table-cell-role="th">gpa</th>
<th data-quarto-table-cell-role="th">work_experience</th>
<th data-quarto-table-cell-role="th">admitted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">25</th>
<td>650</td>
<td>3.7</td>
<td>6</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">26</th>
<td>670</td>
<td>3.3</td>
<td>6</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">27</th>
<td>690</td>
<td>3.7</td>
<td>5</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">28</th>
<td>690</td>
<td>3.7</td>
<td>5</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">29</th>
<td>620</td>
<td>2.7</td>
<td>5</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This dataset describes how much the marks in <code>gmat</code> and <code>gpa</code> exams (read Wikipedia for details about these exams, it’s not relevant now though) and <code>work_experience</code> affect whether a student was admitted to a US college.</p>
<p>Note that we used here <code>tail</code> function, it shows the last rows of a dataframe. Note that the last index is <code>29</code> i.e.&nbsp;the dataframe contains 30 rows (the indexes start with <code>0</code> as usual). Another way to get the dimensions of the dataframe is</p>
<div id="b6c22027" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>(30, 4)</code></pre>
</div>
</div>
<p>i.e.&nbsp;there are 30 rows and 4 columns.</p>
<p>As you can see, the <code>admitted</code> column contains only <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, where <span class="math inline">\(1\)</span> stands for admission, and <span class="math inline">\(0\)</span> for failure; more precisely, we can see this for the last rows only, but we can check this using the following Python trick:</p>
<div id="da70b07a" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(df[<span class="st">'admitted'</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>{0, 1}</code></pre>
</div>
</div>
<p>Here <code>set</code> function returns the set of all values of the column (<em>unique</em> values as it is a set). An alternative Pandas code for this is</p>
<div id="50e547ad" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'admitted'</span>].unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array([0, 1], dtype=int64)</code></pre>
</div>
</div>
</section>
<section id="separating-data" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="separating-data">Separating data</h3>
<p>Now we save the last row in a separate dataframe, call it <code>df_test</code>, and redefine <code>df</code> as the first 29 rows of the original <code>df</code> (you learned the functions below in Python lectures of MA-M06).</p>
<div id="a5ab23ea" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> df.iloc[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[:<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can check that now</p>
<div id="8bc5193e" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df.tail()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">gmat</th>
<th data-quarto-table-cell-role="th">gpa</th>
<th data-quarto-table-cell-role="th">work_experience</th>
<th data-quarto-table-cell-role="th">admitted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">24</th>
<td>690</td>
<td>3.3</td>
<td>3</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25</th>
<td>650</td>
<td>3.7</td>
<td>6</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">26</th>
<td>670</td>
<td>3.3</td>
<td>6</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">27</th>
<td>690</td>
<td>3.7</td>
<td>5</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">28</th>
<td>690</td>
<td>3.7</td>
<td>5</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>i.e.&nbsp;<code>df</code> contains 29 rows only, and</p>
<div id="e7b2ca45" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_test</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>gmat               620.0
gpa                  2.7
work_experience      5.0
admitted             0.0
Name: 29, dtype: float64</code></pre>
</div>
</div>
<p>In particular, the student stored now in <code>df_test</code> was not admitted.</p>
</section>
<section id="logistic-regression-for-1-independent-variable" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="logistic-regression-for-1-independent-variable">Logistic regression for 1 independent variable</h3>
<p>We first study how much the mark in <code>gmat</code> affects the admission. We use the following code:</p>
<div id="519d4eb6" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> smf.logit(<span class="st">'admitted ~ gmat'</span>, data <span class="op">=</span> df).fit()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>reg.summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.485467
         Iterations 6</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="23">
<table class="simpletable caption-top table table-sm table-striped small">
<caption>Logit Regression Results</caption>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dep. Variable:</th>
<td>admitted</td>
<th data-quarto-table-cell-role="th">No. Observations:</th>
<td>29</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Model:</th>
<td>Logit</td>
<th data-quarto-table-cell-role="th">Df Residuals:</th>
<td>27</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Method:</th>
<td>MLE</td>
<th data-quarto-table-cell-role="th">Df Model:</th>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Date:</th>
<td>Thu, 30 Oct 2025</td>
<th data-quarto-table-cell-role="th">Pseudo R-squ.:</th>
<td>0.2990</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Time:</th>
<td>00:41:51</td>
<th data-quarto-table-cell-role="th">Log-Likelihood:</th>
<td>-14.079</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">converged:</th>
<td>True</td>
<th data-quarto-table-cell-role="th">LL-Null:</th>
<td>-20.084</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Covariance Type:</th>
<td>nonrobust</td>
<th data-quarto-table-cell-role="th">LLR p-value:</th>
<td>0.0005289</td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<td></td>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>-17.6764</td>
<td>6.763</td>
<td>-2.614</td>
<td>0.009</td>
<td>-30.932</td>
<td>-4.421</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">gmat</th>
<td>0.0272</td>
<td>0.010</td>
<td>2.644</td>
<td>0.008</td>
<td>0.007</td>
<td>0.047</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It contains a lot of data, we actually need only the values of <code>coef</code> at the bottom part: we want to get (see Lecture Notes)</p>
<p><span class="math display">\[
\mathrm{logit} (p) = \hat{\beta}_0 + \hat{\beta}_1 x_1
\]</span></p>
<p>(here there is only one independent variable, <code>gmat</code>, hence, we use only <span class="math inline">\(x_1\)</span>), and the values of <code>coef</code> in the <code>summary</code> for <code>Intercept</code> is <span class="math inline">\(\hat{\beta}_0\)</span>, whereas the value of <code>gmat</code> in the <code>summary</code> is <span class="math inline">\(\hat{\beta}_1\)</span>. We can access these values directly:</p>
<div id="3bec54a4" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>[reg.params.iloc[<span class="dv">0</span>], reg.params.iloc[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>[-17.67642930546272, 0.027183426815336253]</code></pre>
</div>
</div>
<p>Now, we are going to demonstrate the obtained result graphically. We know that (see Lecture Notes)</p>
<p><span class="math display">\[
p = \frac{e^{\hat{\beta}_0+\hat{\beta}_1 x_1}}{1+e^{\hat{\beta}_0+\hat{\beta}_1 x_1}}
\]</span></p>
<p>We are going now to plot the scatter plot of <code>admitted</code> vs <code>gmat</code> and plot on the same diagram the curve <span class="math inline">\(p=p(x_1)\)</span>. We will use <code>np.exp</code> function for the exponent.</p>
<div id="9938545c" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> df[<span class="st">'gmat'</span>].to_numpy()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> df[<span class="st">'admitted'</span>].to_numpy()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(x1, p)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>b0 <span class="op">=</span> reg.params.iloc[<span class="dv">0</span>]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> reg.params.iloc[<span class="dv">1</span>]</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>x1values <span class="op">=</span> np.linspace(<span class="bu">min</span>(x1), <span class="bu">max</span>(x1), <span class="dv">100</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>pvalues <span class="op">=</span> np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> x1values)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> x1values))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>plt.plot(x1values, pvalues, color <span class="op">=</span> <span class="st">'r'</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab4-solutions_files/figure-html/cell-26-output-1.png" width="571" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can see that the red function separates values of <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.</p>
<p>This function can be used to make predictions about the admission. Namely, we take the value of <code>gmat</code> for the last student of the original dataframe, now stored in the separate dataframe <code>df_test</code>; and then we calculate <span class="math inline">\(p\)</span> at this <span class="math inline">\(x_1=\)</span><code>gmat</code>:</p>
<div id="6c2a20a4" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>gmat <span class="op">=</span> df_test[<span class="st">'gmat'</span>]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> gmat)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> gmat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>0.30518983321629944</code></pre>
</div>
</div>
<p>The received value is more close to <span class="math inline">\(0\)</span> then to <span class="math inline">\(1\)</span>, hence, we may expect that the student would not be admitted; that was the case. Though the value is still relatively large, hence, probably, one mark is not enough to make a good prediction.</p>
</section>
<section id="logistic-regression-for-2-independent-variables" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="logistic-regression-for-2-independent-variables">Logistic regression for 2 independent variables</h3>
<p>However, we expect that the admission depends on both marks, in <code>gmat</code> and in <code>gpa</code>. To take both marks into account one needs to change <code>admitted ~ gmat</code> by <code>admitted ~ gmat + gpa</code> in the previous code.</p>
</section>
<section id="section-7" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="section-7"><span class="header-section-number">2.1</span> </h2>
<div class="task">
<p>Change the code as explained and get the following summary.</p>
<div id="4206b31c" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> smf.logit(<span class="st">'admitted ~ gmat + gpa'</span>, data <span class="op">=</span> df).fit()</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>reg.summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.322141
         Iterations 8</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="27">
<table class="simpletable caption-top table table-sm table-striped small">
<caption>Logit Regression Results</caption>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dep. Variable:</th>
<td>admitted</td>
<th data-quarto-table-cell-role="th">No. Observations:</th>
<td>29</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Model:</th>
<td>Logit</td>
<th data-quarto-table-cell-role="th">Df Residuals:</th>
<td>26</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Method:</th>
<td>MLE</td>
<th data-quarto-table-cell-role="th">Df Model:</th>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Date:</th>
<td>Thu, 30 Oct 2025</td>
<th data-quarto-table-cell-role="th">Pseudo R-squ.:</th>
<td>0.5348</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Time:</th>
<td>00:41:51</td>
<th data-quarto-table-cell-role="th">Log-Likelihood:</th>
<td>-9.3421</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">converged:</th>
<td>True</td>
<th data-quarto-table-cell-role="th">LL-Null:</th>
<td>-20.084</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Covariance Type:</th>
<td>nonrobust</td>
<th data-quarto-table-cell-role="th">LLR p-value:</th>
<td>2.162e-05</td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<td></td>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>-22.0171</td>
<td>9.232</td>
<td>-2.385</td>
<td>0.017</td>
<td>-40.111</td>
<td>-3.923</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">gmat</th>
<td>0.0150</td>
<td>0.014</td>
<td>1.052</td>
<td>0.293</td>
<td>-0.013</td>
<td>0.043</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">gpa</th>
<td>3.7604</td>
<td>2.003</td>
<td>1.877</td>
<td>0.060</td>
<td>-0.166</td>
<td>7.686</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Again, the coefficients are available using (in the previous notations) <code>reg.params</code>. As before, <code>Intercept</code> stands for <span class="math inline">\(\hat{\beta}_0\)</span>, <code>gmat</code> stands for <span class="math inline">\(\hat{\beta}_1\)</span>, and also <code>gpa</code> stands for <span class="math inline">\(\hat{\beta}_2\)</span> in</p>
<p><span class="math display">\[
\mathrm{logit} (p) = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \hat{\beta}_2 x_2
\]</span></p>
<p>and hence</p>
<p><span class="math display">\[
p = \frac{e^{\hat{\beta}_0+\hat{\beta}_1 x_1+\hat{\beta}_2 x_2}}{1+e^{\hat{\beta}_0+\hat{\beta}_1 x_1+\hat{\beta}_2 x_2}}
\]</span></p>
<p>We can show how <span class="math inline">\(p\)</span> separates the values (some lines of the code may be new for you - it’s just for your information, <strong>you are not required to learn them</strong>):</p>
<div id="72fed8e9" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> df[<span class="st">'gmat'</span>].to_numpy()</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> df[<span class="st">'gpa'</span>].to_numpy()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> df[<span class="st">'admitted'</span>].to_numpy()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, projection<span class="op">=</span><span class="st">'3d'</span>, computed_zorder<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>x1values <span class="op">=</span> np.linspace(<span class="bu">min</span>(x1), <span class="bu">max</span>(x1), <span class="dv">100</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>x2values <span class="op">=</span> np.linspace(<span class="bu">min</span>(x2), <span class="bu">max</span>(x2), <span class="dv">100</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>[X1, X2] <span class="op">=</span> np.meshgrid(x1values, x2values)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>b0 <span class="op">=</span> reg.params.iloc[<span class="dv">0</span>]</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> reg.params.iloc[<span class="dv">1</span>]</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> reg.params.iloc[<span class="dv">2</span>]</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>pvalues <span class="op">=</span> np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> X1 <span class="op">+</span> b2 <span class="op">*</span> X2)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> X1 <span class="op">+</span> b2 <span class="op">*</span> X2))</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(X1, X2, pvalues, color <span class="op">=</span> <span class="st">'r'</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>ax.scatter(x1, x2, p)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab4-solutions_files/figure-html/cell-29-output-1.png" width="407" height="389" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As you can see, the red graph (surface) of <span class="math inline">\(p\)</span> separates values of <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. Again, we may try to predict the admission for the student with data stored in <code>df_test</code>. We assigned to <code>gmat</code> the corresponding mark, now we do the same for <code>gpa</code> and calculate <code>p</code> for these two values. As you can see, the result is much closer to <span class="math inline">\(0\)</span>, hence, we are more confident in our (correct) prediction that the student would not be admitted.</p>
<div id="6f96a06f" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>gpa <span class="op">=</span> df_test[<span class="st">'gpa'</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> gmat <span class="op">+</span> b2 <span class="op">*</span> gpa)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> gmat <span class="op">+</span> b2 <span class="op">*</span> gpa))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>0.07118806995711167</code></pre>
</div>
</div>
<section id="logistic-regression-for-3-independent-variables" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="logistic-regression-for-3-independent-variables">Logistic regression for 3 independent variables</h3>
<p>Now, we consider the dependence of <code>admitted</code> on all three values: <code>gmat</code>, <code>gpa</code>, and <code>work_experience</code>. Surely, in this case, we will not be able to draw <span class="math inline">\(p\)</span> (as it would be a 4-dimensional diagram), but we can calculate <span class="math inline">\(\hat{\beta}_0,\hat{\beta}_1,\hat{\beta}_2,\hat{\beta}_3\)</span>.</p>
</section>
</section>
<section id="section-8" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="section-8"><span class="header-section-number">2.2</span> </h2>
<div class="task">
<p>Find the coefficients of</p>
<p><span class="math display">\[
\mathrm{logit} (p) = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \hat{\beta}_2 x_2 + \hat{\beta}_3 x_3
\]</span></p>
<div id="a51362d1" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> smf.logit(<span class="st">'admitted ~ gmat + gpa + work_experience'</span>, data <span class="op">=</span> df).fit()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.255306
         Iterations 8</code></pre>
</div>
</div>
<p>Check your answer:</p>
<div id="53a38775" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>reg.params</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>Intercept         -16.182243
gmat                0.002624
gpa                 3.258770
work_experience     0.994371
dtype: float64</code></pre>
</div>
</div>
</div>
</section>
<section id="section-9" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="section-9"><span class="header-section-number">2.3</span> </h2>
<div class="task">
<p>Assign to <code>w_exp</code> the work experience value for the student from <code>df_test</code> and calculate the function</p>
<p><span class="math display">\[
p = \frac{e^{\hat{\beta}_0+\hat{\beta}_1 x_1+\hat{\beta}_2 x_2+\hat{\beta}_3 x_3}}{1+e^{\hat{\beta}_0+\hat{\beta}_1 x_1+\hat{\beta}_2 x_2+\hat{\beta}_3 x_3}}
\]</span></p>
<p>for that student. Check the answer:</p>
<div id="b4ab9118" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>w_exp <span class="op">=</span> df_test[<span class="st">'work_experience'</span>]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>b0, b1, b2, b3 <span class="op">=</span> reg.params <span class="co">#Note the trick</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> gmat <span class="op">+</span> b2 <span class="op">*</span> gpa <span class="op">+</span> b3 <span class="op">*</span> w_exp)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(b0 <span class="op">+</span> b1 <span class="op">*</span> gmat <span class="op">+</span> b2 <span class="op">*</span> gpa <span class="op">+</span> b3 <span class="op">*</span> w_exp))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>0.31333312863167756</code></pre>
</div>
</div>
</div>
<p>As you can see, the information about a relatively high work experience (5 years in this case), increased chances to be admitted, though the non-admission is still more likely.</p>
<p>Note that the rest of information from <code>summary</code> actually explains the level of certainty we may have in the future prediction (we do not consider this now). Note also that, in practice, one predicts outcomes for a number of students (the dataframe <code>df_test</code> would contain a lot of rows), and the prediction is “good” if one predicted correctly for a big percentage of them.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Lab3-solutions.html" class="pagination-link" aria-label="Lab 3 - Solutions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lab 3 - Solutions</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Dmitri Finkelshtein, Kristian Evans</p>
</div>   
    <div class="nav-footer-center">
<p>MA-M27: Lab Assignments</p>
</div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>